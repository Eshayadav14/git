Substitutions

Component Name: Substitutions
Tag Name: <cart-substitutional>
Nature of the Component: Dynamic Component
Location: ui.frontend.react/src/components/Substitution

⸻

Description

The Substitutions component enables users to choose substitution options for products in their cart that may go out of stock. It allows users to either individually enable substitution per item or apply the substitution rule to all eligible products in a single click. The component includes a modal explaining what a substitution is.

⸻

How the Component Works

Functionality:
	•	Displays all substitutable products in the cart.
	•	Provides individual checkboxes for each product to allow substitutions.
	•	Provides a master checkbox to apply substitution settings to all products.
	•	Clicking on the “What’s a substitution?” link opens an informational modal.
	•	Clicking the “Continue” button takes the user to the checkout page.

⸻

Major Elements
	•	Substitution Info Link: Opens a modal explaining substitutions.
	•	Master Checkbox: Allows enabling/disabling substitutions for all eligible products.
	•	Individual Checkbox: Shown per substitutable product to enable substitution individually.
	•	Continue Button: Proceeds to checkout.
	•	Modal Component: Displays the explanation of substitutions.

⸻

Integration Requirements with AEM

Integration:

Component is configured using a JSON object passed via substitutionaldata attribute:


API Integration & Endpoints
	•	getCartSubtitutionApi: API call dispatched when substitution settings are changed. Payload includes shopping list and product IDs along with substitution preferences.

⸻

Component Behavior
	•	Default State:
	•	All checkboxes are unchecked.
	•	Master checkbox is not selected and shows indeterminate state if some but not all individual checkboxes are selected.
	•	User Interaction:
	•	Toggling master checkbox sets all individual checkboxes.
	•	Toggling individual checkboxes updates master checkbox state accordingly.
	•	Modal link triggers a modal with substitution info and CTA.
	•	Clicking “Continue” redirects to checkout page.

⸻

Component Variations & UI States
	1.	All Products Substitutable
	•	Master checkbox is available.
	•	Each product row shows individual substitution toggle.
	2.	Some Products Substitutable
	•	Only substitutable products are shown.
	•	Master checkbox supports indeterminate state.
	3.	Modal Opened
	•	Displays substitution info with:
	•	Title
	•	Description
	•	Optional second paragraph
	•	OK button to close modal

⸻

Visual Reference & Styling Notes
	•	Checkboxes:
	•	Square, outlined in grey.
	•	Checked state shows a tick in white over black background.
	•	Continue Button:
	•	Yellow brand background.
	•	Black font.
	•	Modal:
	•	Standard modal layout with cross icon, title, body text, and CTA.

⸻

Analytics Events
	•	SUBSTITUTION_DISPLAYED: Triggered on load with allSelected state.
	•	SUBSTITUTION_SELECTED: Triggered when individual or master checkbox is changed.

⸻

Linked Files
	•	ReduxProvider – app/ReduxProvider
	•	Actions – app/actions.ts (getCartSubtitutionApi)
	•	SubstitutionItems – components/Substitution/substitutionItems.tsx
	•	ModalComponent – components/modals/index.tsx
	•	Styles – components/Substitution/index.scss

⸻

Figma Reference
	•	Figma File: AEM Delivery - Cumberland
